{% extends 'personal/basic_profile.html' %}

{% block machineDetails %}
<div class="container-fluid pt-4 px-4">
  <div class="bg-secondary rounded-top p-4">
    <h1>Detalles de la maquina {{relacion_maquina_jugador.maquina_vulnerable}}</h1>
    <!-- DescripciÃ³n de la maquina -->
    <p>Nivel de dificultad: {{ relacion_maquina_jugador.maquina_vulnerable.nivel_dificultad }}</p>
    <p>{{ relacion_maquina_jugador.maquina_vulnerable.descripcion|default:"" }}</p>

    {% if relacion_maquina_jugador.activa %}
    <!-- Formulario para introducir la flag 1 -->
    <form id="flag1" action="{% url 'flag' nombre_maquina=relacion_maquina_jugador.maquina_vulnerable %}" method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label for="flag1" class="form-label">Flag 1</label>
        <input type="text" class="form-control" id="flag1" name="flag1">
      </div>
      <button type="submit" class="btn btn-primary">Enviar</button>
    </form>
    <!-- End of flag 1 form -->

    <!-- Formulario para introducir la flag 2 -->
    <form id="flag2" action="{% url 'flag' nombre_maquina=relacion_maquina_jugador.maquina_vulnerable %}" method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label for="flag2" class="form-label">Flag 2</label>
        <input type="text" class="form-control" id="flag2" name="flag2">
      </div>
      <button type="submit" class="btn btn-primary">Enviar</button>
    </form>
    <!-- End of flag 2 form -->
    <p>IP: {{ relacion_maquina_jugador.ip_address }}</p>
    {% if messages %}
        <div class="bg-secondary rounded h-100 p-4">
          {% for message in messages %}
          <!-- Si el mensaje es de exito usar class="alert alert-success" role="alert" -->
          {% if message.tags == 'success' %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
              {{ message }}
          </div>
          <!-- Si el mensaje es de informacion usar class="alert alert-info" role="alert" -->
          {% elif message.tags == 'info' %}
            <div class="alert alert-info alert-dismissible fade show" role="alert">
              {{ message }}
          </div>
          {% elif message.tags == 'error' %}
          <div class="alert alert-danger alert-dismissible fade show" role="alert">
          <i class="fa fa-exclamation-circle me-2"></i>
            {{ message }}
          {% endif %}
          {% endfor %}
      </div>
    {% endif %}
    <div>
      <form id="desactivar_maquina" onclick="mostrarIndicadorDeCarga('desactivar_maquina')" action="{% url 'desactivar_maquina' nombre_maquina=relacion_maquina_jugador.maquina_vulnerable %}" method="post">
        {% csrf_token %}
      <button id="miBoton" type="submit" class="btn btn-danger">Desactivar</button>
      </form>
    </div>
    {% else %}
    <div>
      <form id="desactivar_maquina" onclick="mostrarIndicadorDeCarga('desactivar_maquina')" action="{% url 'activar_maquina' nombre_maquina=relacion_maquina_jugador.maquina_vulnerable %}" method="post">
      {% csrf_token %}
      <button id="miBoton" type="submit" class="btn btn-success">Activar </button>
      </form>
    </div>

    {% if messages %}
    <div class="col-sm-12 col-xl-3">
      <div class="alert alert-primary alert-dismissible fade show">
        <i class="fa fa-exclamation-circle me-2"></i>
        {% for message in messages %}
          <!-- Si el mensaje es de error -->
          {% if message.tags == 'error' %}
            {{ message }}
          {% elif message.tags == 'success' %}
            <p> {{ message }} </p>
          {% endif %}
        {% endfor %}
        <button type="button" class="btn-close" aria-label="Close" data-bs-dismiss="alert"></button>
      </div>
    </div>
    {% endif %}
      <!-- End of messages -->
    {% endif %}
      <!-- End of inactive machine -->
  </div>
</div>
{% endblock %}